<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge"/>
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="robots" content="noindex,nofollow">
    <link href="../layui/css/layui.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/xadmin-while.css">
    <script src="../layui/layui.js"></script>
</head>
<style>
	 body{padding: 0; margin: 0;}
	 .layui-table-view{border: none;}
	 .layui-fluid{padding-top: 10px;}
	 .layui-fluid .layui-form{padding-bottom: 10px;}
	 .tishi-line{background-color: #fff; width:calc(100% - 30px); height: 40px; line-height: 40px; padding: 0 15px; font-weight: bold; color:#ff5722;}
</style>
<body>
<div class="x-nav">
	<span class="layui-breadcrumb">
		<a><cite>Homepage</cite></a> 
		<a><cite>Static Data Center</cite></a> 
		<a><cite>Purchased List</cite></a>
	</span>
	<a class="layui-btn layui-btn-xs" onclick="location.reload()" title="Refresh">
		<i class="layui-icon layui-icon-refresh-3"></i>
	</a>
</div>
<div class="layui-fluid">
	<div class="layui-row">		
		<div class="table">
			<form class="layui-form">
				<div class="layui-row layui-col-space16">
					<div class="layui-col-md2">
						<div class="layui-input-wrap">
							<div class="layui-input-prefix">
								<i class="layui-icon layui-icon-website"></i>
							</div>
							<select>
								<option value="">All Statuses</option>
								<option value="normal">Normal</option>
								<option value="deactivate">Deactivate</option>
								<option value="expired">Expired</option>
								<option value="balance">Insufficient balance/traffic</option>
								<option value="anomalies">Line Anomalies</option>
							</select>
						</div>
					</div>
					<div class="layui-col-md2">
						<div class="layui-input-wrap">
							<div class="layui-input-prefix">
								<i class="layui-icon layui-icon-home"></i>
							</div>
							<select>
								<option value="">All Country</option>
								<option value="US">US</option>
								<option value="GB">GB</option>
								<option value="FR">FR</option>
							</select>
						</div>
					</div>
					<div class="layui-col-md2">
						<div class="layui-input-wrap">
							<div class="layui-input-prefix">
								<i class="layui-icon layui-icon-note"></i>
							</div>
							<input type="text" placeholder="Please enter search content" class="layui-input">
						</div>
					</div>
					<div class="layui-col-md6">
						<button type="submit" class="layui-btn" lay-submit lay-filter="search"><i class="layui-icon layui-icon-search"></i> Search</button>
						<button type="reset" class="layui-btn layui-btn-primary"><i class="layui-icon layui-icon-refresh-3"></i> Reset</button>
						<button type="button" class="layui-btn layui-bg-blue"><i class="layui-icon layui-icon-export"></i> Export Proxy</button>
					</div>
				</div>
			</form>
			<table id="data_center" lay-filter="data_center"></table>
			<div class="tishi-line">Note: All products only support use in overseas network environments.</div>
		</div>
	</div>
</div>
<script>
layui.extend({
	common: '../modules/common'
});
layui.use(['table','form','element','common'], function(){
	var $ = layui.jquery
		,table = layui.table
		,form = layui.form
		,element = layui.element
		,common = layui.common;
	
	var user;
	user = JSON.parse(localStorage.getItem("admin"));
	if(user == null){
		window.location.href='../login.html';  
	}
	var server = 'http://' + user.device_ip + ':12569/';
	
	var data_center_url = server + "sv5-flow/get_page/" + user.user_id;
	var user_manage = table.render({
		elem: '#data_center'
		,height: 'full-180'
		,url: data_center_url
		,page: {
			layout: ['prev', 'page', 'next', 'skip', 'count','limit'],
		}
		,limit:50
		,limits:[50,100,200]
		,skin:'nob'
		,text: {none: 'No Data'}
		,request: {
		  pageName: 'page_index',
		  limitName: 'page_size'
		}
		,cols: [[
			{field: 'id', title: 'Proxy ID',align:'center'}
			,{field: 'agency_agreement', title: 'Agency Agreement',width:180,align:'center'}
			,{field: 'address', title: 'Server address',align:'center'}
			,{field: 'port', title: 'PORT',align:'center',}
			,{field: 'code', title: 'QR code',align:'center'}
			,{field: 'country', title: 'Country/Region',width:150,align:'center'}
			,{field: 'export_ip', title: 'Export IP',align:'center'}
			,{field: 'time', title: 'Purchase time/Expiration time',width:250,align:'center'}
			,{field: 'status', title: 'Agent Status',align:'center'}
			,{field: 'remainder', title: 'Remainder',align:'center'}
		]],
		done: function(res, curr, count, origin){
		    element.render();
		},
		error: function(res){
			var errorText = 'Data loading failed!';	
			if (res.status === 404) {
				errorText = 'The data interface does not exist!';
			} else if (res.status === 500) {
				errorText = 'Server error!';
			}
			$('.layui-table-main .layui-none').text(errorText);
		},
		parseData: function(res){
			return {
				"code": 0,
				"msg": res.message,
				"count": res.data.recordCount,
				"data": res.data.data
			};
		}
	});
		
	window.formatNumber = function(num, n) {
	    const units = ["B", "KB", "MB", "GB", "TB"];
	    let unitIndex = 0;
	    while (num >= 1000 && unitIndex < units.length) {
	        num /= 1000;
	        unitIndex++;
	    }
	    const roundedNum = num.toFixed(n);
	    return `${roundedNum}${units[unitIndex]}`;
	}
	
	table.on('tool(data_center)', function(obj){
		var data = obj.data;
		if(obj.event === 'disable'){
			parent.layer.prompt({title: 'Please enter the administrator password!',btn: ['submit', 'cancel']}, function(value, index, elem){
				if(value === '') return elem.focus();
				var post_url = server + "sv5-flow/disabled/" + value + "/" + data.id;
				common.doAjaxTableReload(post_url,"GET","data_center",0);
			});
		}
	});
	
});
</script>
</body>
</html>